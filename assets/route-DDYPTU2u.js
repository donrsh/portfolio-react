import{R as w,j as e,r as c}from"./jsx-runtime-JVR6BLX4.js";import{c as S,u as k}from"./with-selector-DyLZNxmq.js";import{S as D}from"./SourceCodeRefs-eH_TNRw1.js";import{B as u}from"./button-CQLrvouU.js";import{D as z,a as C,b as R,c as A,I as P}from"./input-CS4-b340.js";import{T as f}from"./typogrphy-CnSYUxEe.js";import{c as T}from"./createLucideIcon-CPprh6VQ.js";import"./link-DttI-9YJ.js";import"./react-icons.esm-CvWY3AL7.js";import"./index-C1zmamBb.js";import"./cn-DTPrpecD.js";import"./index-B0C4uFRs.js";/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=T("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=T("TimerReset",[["path",{d:"M10 2h4",key:"n1abiw"}],["path",{d:"M12 14v-4",key:"1evpnu"}],["path",{d:"M4 13a8 8 0 0 1 8-7 8 8 0 1 1-5.3 14L4 17.6",key:"1ts96g"}],["path",{d:"M9 17H4v5",key:"8t5av"}]]);var v={BASE_URL:"/portfolio-react/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{useDebugValue:F}=w,{useSyncExternalStoreWithSelector:N}=k;let j=!1;const _=t=>t;function O(t,i=_,r){(v?"production":void 0)!=="production"&&r&&!j&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),j=!0);const n=N(t.subscribe,t.getState,t.getServerState||t.getInitialState,i,r);return F(n),n}const y=t=>{(v?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const i=typeof t=="function"?S(t):t,r=(n,o)=>O(i,n,o);return Object.assign(r,i),r},L=t=>t?y(t):y,W=({expireTime:t,watchExpireIntervalDelay:i=1e3})=>L()((r,n)=>{let o=null,l=null;const p=()=>{o=null,r({current:null})},m=()=>{o=Date.now(),typeof l=="number"&&clearInterval(l),l=window.setInterval(()=>{if(typeof o!="number"){clearInterval(l);return}if(Date.now()-o>t){p();return}},i)};return{isPrompting:!1,prompt(){r({isPrompting:!0})},promptConfirm(s){if(!n().isPrompting){console.warn("[TmpAuthorizationStore] store.isisPrompting is `false` now. This is no-op.");return}m(),r({isPrompting:!1,current:s})},promptCancel(){if(!n().isPrompting){console.warn("[TmpAuthorizationStore] store.isisPrompting is `false` now. This is no-op.");return}r({isPrompting:!1})},current:null,clear:p,prolong(s){if(typeof o!="number")return null;o+=s},getTimeToExpire(){if(typeof o!="number")return null;const s=o+t-Date.now();return s>0?s:null}}}),B=[{title:"This page",link:"https://github.com/donrsh/portfolio-react/blob/main/app/routes/demo.useTmpAuthorization-zustand/route.tsx"},{title:e.jsxs(e.Fragment,{children:[e.jsx("code",{children:"TmpAuthorization"})," type def"]}),link:"https://github.com/donrsh/web-apps-workspace/blob/main/libs/react/src/hooks/useTmpAuthorization/types/index.ts"},{title:e.jsxs(e.Fragment,{children:[e.jsx("code",{children:"useTmpAuthorization"})," zustand implementation"]}),link:"https://github.com/donrsh/web-apps-workspace/tree/main/libs/react/src/hooks/useTmpAuthorization/zustand"}],H=W({expireTime:3*60*1e3});function te(){const{current:t,prompt:i,isPrompting:r,promptCancel:n,promptConfirm:o,getTimeToExpire:l,prolong:p,clear:m}=H(),s=c.useRef(),x=c.useRef(),[g,b]=c.useState();c.useEffect(()=>{var a,d;r?(a=s.current)==null||a.showModal():(d=s.current)==null||d.close()},[r]),c.useEffect(()=>{clearInterval(x.current),b(void 0),t&&(x.current=window.setInterval(()=>{b(Math.round((l()??0)/1e3))},1e3))},[t]);const E=c.useCallback(a=>{a.preventDefault();const h=new FormData(a.target).get("name");h&&h.trim()&&o({name:h})},[]);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4",children:t?e.jsxs(e.Fragment,{children:[e.jsxs(f,{variant:"large",children:["Hi, ",t.name]}),e.jsx(f,{variant:"muted",className:"min-h-10",children:g?`Your session will expire in ${g} seconds`:" "}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(u,{onClick:()=>p(5*60*1e3),size:"sm",children:[e.jsx(M,{className:"mr-2"}),"prolong 5 mins"]}),e.jsxs(u,{onClick:m,size:"sm",children:[e.jsx(I,{className:"mr-2"}),"leave"]})]})]}):e.jsxs(z,{open:r,onOpenChange:a=>{a||n()},children:[e.jsx(C,{asChild:!0,children:e.jsx(u,{onClick:i,children:"Click to start!"})}),e.jsx(R,{children:e.jsx(A,{children:e.jsxs("form",{onSubmit:E,children:[e.jsx(f,{children:"What's your name?"}),e.jsx(P,{type:"text",name:"name",id:""}),e.jsx("br",{}),e.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[e.jsx(u,{type:"button",onClick:n,variant:"outline",className:"ml-auto",children:"cancel"}),e.jsx(u,{type:"submit",children:"confirm"})]})]})})})]})}),e.jsx("hr",{}),e.jsx(D,{open:!0,data:B})]})}export{te as default};
