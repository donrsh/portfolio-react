import{R as w,j as t,r as u}from"./jsx-runtime-JVR6BLX4.js";import{c as T,u as y}from"./with-selector-DyLZNxmq.js";import{S as v}from"./SourceCodeRefs-BEihfqrU.js";var j={BASE_URL:"/portfolio-react/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{useDebugValue:S}=w,{useSyncExternalStoreWithSelector:z}=y;let g=!1;const C=e=>e;function D(e,i=C,n){(j?"production":void 0)!=="production"&&n&&!g&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),g=!0);const s=z(e.subscribe,e.getState,e.getServerState||e.getInitialState,i,n);return S(s),s}const b=e=>{(j?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const i=typeof e=="function"?T(e):e,n=(s,r)=>D(i,s,r);return Object.assign(n,i),n},k=e=>e?b(e):b,A=({expireTime:e,watchExpireIntervalDelay:i=1e3})=>k()((n,s)=>{let r=null,a=null;const c=()=>{r=null,n({current:null})},p=()=>{r=Date.now(),typeof a=="number"&&clearInterval(a),a=window.setInterval(()=>{if(typeof r!="number"){clearInterval(a);return}if(Date.now()-r>e){c();return}},i)};return{isPrompting:!1,prompt(){n({isPrompting:!0})},promptConfirm(o){if(!s().isPrompting){console.warn("[TmpAuthorizationStore] store.isisPrompting is `false` now. This is no-op.");return}p(),n({isPrompting:!1,current:o})},promptCancel(){if(!s().isPrompting){console.warn("[TmpAuthorizationStore] store.isisPrompting is `false` now. This is no-op.");return}n({isPrompting:!1})},current:null,clear:c,prolong(o){if(typeof r!="number")return null;r+=o},getTimeToExpire(){if(typeof r!="number")return null;const o=r+e-Date.now();return o>0?o:null}}}),P=[{title:"This page",link:"https://github.com/donrsh/portfolio-react/blob/main/app/routes/demo.useTmpAuthorization-zustand/route.tsx"},{title:t.jsxs(t.Fragment,{children:[t.jsx("code",{children:"TmpAuthorization"})," type def"]}),link:"https://github.com/donrsh/web-apps-workspace/blob/main/libs/react/src/hooks/useTmpAuthorization/types/index.ts"},{title:t.jsxs(t.Fragment,{children:[t.jsx("code",{children:"useTmpAuthorization"})," zustand implementation"]}),link:"https://github.com/donrsh/web-apps-workspace/tree/main/libs/react/src/hooks/useTmpAuthorization/zustand"}],R=A({expireTime:3*60*1e3});function W(){const{current:e,prompt:i,isPrompting:n,promptCancel:s,promptConfirm:r,getTimeToExpire:a,prolong:c,clear:p}=R(),o=u.useRef(),f=u.useRef(),[h,x]=u.useState();u.useEffect(()=>{var l,m;n?(l=o.current)==null||l.showModal():(m=o.current)==null||m.close()},[n]),u.useEffect(()=>{clearInterval(f.current),x(void 0),e&&(f.current=window.setInterval(()=>{x(Math.round((a()??0)/1e3))},1e3))},[e]);const E=u.useCallback(l=>{l.preventDefault();const d=new FormData(l.target).get("name");d&&d.trim()&&r({name:d})},[]);return t.jsxs(t.Fragment,{children:[t.jsx("div",{children:e?t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:["Hi, ",e.name," ",h&&h+"s"]}),t.jsxs("div",{style:{display:"flex",gap:8},children:[t.jsx("button",{onClick:()=>c(5*60*1e3),children:"prolong 5 mins"}),t.jsx("button",{onClick:p,children:"leave"})]})]}):t.jsx("button",{onClick:i,children:"Click to start!"})}),t.jsx("dialog",{ref:o,children:t.jsxs("form",{onSubmit:E,children:[t.jsx("p",{children:"What's your name?"}),t.jsx("input",{type:"text",name:"name",id:""}),t.jsx("br",{}),t.jsxs("div",{className:"row-vcenter",style:{marginTop:20,justifyContent:"space-between"},children:[t.jsx("button",{type:"button",onClick:s,children:"cancel"}),t.jsx("button",{type:"submit",children:"confirm"})]})]})}),t.jsx("hr",{}),t.jsx(v,{open:!0,data:P,style:{marginBlock:16}})]})}export{W as default};
